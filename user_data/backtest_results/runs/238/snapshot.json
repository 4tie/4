{
  "version": 1,
  "createdAt": "2026-02-07T06:18:30.348Z",
  "backtestId": 238,
  "strategyPath": "user_data/strategies/mabStra.py",
  "strategyContent": "# Author: @Mablue (Masoud Azizi)\n# github: https://github.com/mablue/\n# IMPORTANT: DO NOT USE IT WITHOUT HYPEROPT:\n# freqtrade hyperopt --hyperopt-loss SharpeHyperOptLoss --spaces all --strategy mabStra --config config.json -e 100\n\n# --- Do not remove these libs ---\nfrom freqtrade.strategy import IntParameter, DecimalParameter, IStrategy\nfrom pandas import DataFrame\n# --------------------------------\n\n# Add your lib to import here\nimport talib.abstract as ta\nimport numpy as np\n\n\nclass mabStra(IStrategy):\n    \"\"\"\n    Enhanced Moving Average Crossover Strategy with Trend Filter and Volume Confirmation\n    \n    This strategy uses:\n    - Fast/Slow MA crossovers for entry signals\n    - Trend filter (SMA 200) to trade with the trend\n    - Volume surge confirmation for entries\n    - ATR-based trailing stop for exits\n    - Additional technical indicators for robustness\n    \"\"\"\n    \n    INTERFACE_VERSION: int = 3\n    \n    # Strategy settings\n    timeframe = '1h'\n    startup_candle_count: int = 200  # Need 200 candles for SMA 200\n    \n    # Disable short trading (long only strategy)\n    can_short: bool = True\n    \n    # ROI table - Fixed: keys should be integers (minutes), not strings\n    minimal_roi = {\n        0: 0.10,    # 10% at any duration\n        60: 0.05,   # 5% after 60 minutes\n        240: 0.02,  # 2% after 4 hours\n        1440: 0.01, # 1% after 24 hours\n    }\n    \n    # Stoploss\n    stoploss = -0.05  # 10% stoploss\n    \n    # Trailing stop settings\n    trailing_stop = True\n    trailing_stop_positive = 0.02  # Activate trailing stop at 2% profit\n    trailing_stop_positive_offset = 0.04  # Offset from current price\n    trailing_only_offset_is_reached = False\n    \n    # Hyperoptable parameters - Buy side\n    buy_fast_ma_timeframe = IntParameter(5, 20, default=10, space='buy')\n    buy_slow_ma_timeframe = IntParameter(20, 50, default=30, space='buy')\n    buy_div_min = DecimalParameter(0.95, 0.99, default=0.98, decimals=3, space='buy')\n    buy_div_max = DecimalParameter(1.01, 1.05, default=1.02, decimals=3, space='buy')\n    buy_volume_multiplier = DecimalParameter(1.1, 2.0, default=1.2, decimals=1, space='buy')\n    \n    # Hyperoptable parameters - Sell side\n    sell_fast_ma_timeframe = IntParameter(5, 20, default=10, space='sell')\n    sell_slow_ma_timeframe = IntParameter(20, 50, default=30, space='sell')\n    sell_div_min = DecimalParameter(0.95, 0.99, default=0.98, decimals=3, space='sell')\n    sell_div_max = DecimalParameter(1.01, 1.05, default=1.02, decimals=3, space='sell')\n    \n    # ATR multiplier for trailing stop\n    atr_multiplier = DecimalParameter(1.5, 3.0, default=2.0, decimals=1, space='sell')\n    \n    # RSI parameters for additional filter\n    rsi_period = IntParameter(10, 20, default=14, space='buy')\n    rsi_min = IntParameter(20, 40, default=30, space='buy')\n    rsi_max = IntParameter(60, 80, default=70, space='sell')\n    \n    def populate_indicators(self, dataframe: DataFrame, metadata: dict) -> DataFrame:\n        \"\"\"\n        Calculate all technical indicators used by the strategy\n        \"\"\"\n        # Calculate moving averages for buy signals\n        dataframe['buy-fastMA'] = ta.SMA(dataframe['close'], timeperiod=self.buy_fast_ma_timeframe.value)\n        dataframe['buy-slowMA'] = ta.SMA(dataframe['close'], timeperiod=self.buy_slow_ma_timeframe.value)\n        \n        # Calculate moving averages for sell signals\n        dataframe['sell-fastMA'] = ta.SMA(dataframe['close'], timeperiod=self.sell_fast_ma_timeframe.value)\n        dataframe['sell-slowMA'] = ta.SMA(dataframe['close'], timeperiod=self.sell_slow_ma_timeframe.value)\n        \n        # Add ATR for trailing stop and volatility measurement\n        dataframe['atr'] = ta.ATR(dataframe, timeperiod=14)\n        \n        # Add trend filter (SMA 200)\n        dataframe['trend'] = ta.SMA(dataframe['close'], timeperiod=200)\n        \n        # Add RSI for additional confirmation\n        dataframe['rsi'] = ta.RSI(dataframe, timeperiod=self.rsi_period.value)\n        \n        # Add EMA for additional trend confirmation\n        dataframe['ema_50'] = ta.EMA(dataframe['close'], timeperiod=50)\n        \n        # Add MACD for momentum confirmation\n        macd = ta.MACD(dataframe, fastperiod=12, slowperiod=26, signalperiod=9)\n        dataframe['macd'] = macd['macd']\n        dataframe['macd_signal'] = macd['macdsignal']\n        dataframe['macd_hist'] = macd['macdhist']\n        \n        # Add Bollinger Bands for volatility-based entries\n        bollinger = ta.BBANDS(dataframe, timeperiod=20, nbdevup=2, nbdevdn=2, matype=0)\n        dataframe['bb_upper'] = bollinger['upperband']\n        dataframe['bb_middle'] = bollinger['middleband']\n        dataframe['bb_lower'] = bollinger['lowerband']\n        \n        # Calculate volume moving average\n        dataframe['volume_ma'] = ta.SMA(dataframe['volume'], timeperiod=20)\n        \n        return dataframe\n\n    def populate_entry_trend(self, dataframe: DataFrame, metadata: dict) -> DataFrame:\n        \"\"\"\n        Define entry conditions for long positions\n        \"\"\"\n        # Entry conditions with multiple confirmations\n        dataframe.loc[\n            (\n                # Trend filter: Price above long-term trend\n                (dataframe['close'] > dataframe['trend']) &\n                \n                # Volume confirmation: Volume surge above average\n                (dataframe['volume'] > dataframe['volume_ma'] * self.buy_volume_multiplier.value) &\n                \n                # MA crossover condition: Fast MA close to Slow MA (crossover zone)\n                (dataframe['buy-fastMA'].div(dataframe['buy-slowMA']) > self.buy_div_min.value) &\n                (dataframe['buy-fastMA'].div(dataframe['buy-slowMA']) < self.buy_div_max.value) &\n                \n                # RSI filter: Not overbought\n                (dataframe['rsi'] < self.rsi_max.value) &\n                (dataframe['rsi'] > self.rsi_min.value) &\n                \n                # MACD confirmation: MACD above signal line (bullish momentum)\n                (dataframe['macd'] > dataframe['macd_signal']) &\n                \n                # Price not too far from Bollinger middle (avoid buying at extremes)\n                (dataframe['close'] < dataframe['bb_upper']) &\n                (dataframe['close'] > dataframe['bb_lower'])\n            ),\n            'enter_long'] = 1\n        \n        return dataframe\n\n    def populate_exit_trend(self, dataframe: DataFrame, metadata: dict) -> DataFrame:\n        \"\"\"\n        Define exit conditions for long positions\n        \"\"\"\n        # Calculate dynamic trailing stop based on ATR\n        trailing_stop = dataframe['low'] - (self.atr_multiplier.value * dataframe['atr'])\n        \n        # Exit conditions\n        dataframe.loc[\n            (\n                # Trailing stop hit\n                (dataframe['close'] < trailing_stop) |\n                \n                # MA crossover exit: Fast MA diverges from Slow MA\n                (\n                    (dataframe['sell-fastMA'].div(dataframe['sell-slowMA']) > self.sell_div_max.value) |\n                    (dataframe['sell-fastMA'].div(dataframe['sell-slowMA']) < self.sell_div_min.value)\n                ) |\n                \n                # RSI overbought exit\n                (dataframe['rsi'] > self.rsi_max.value) |\n                \n                # MACD bearish crossover\n                (dataframe['macd'] < dataframe['macd_signal']) &\n                (dataframe['macd_hist'] < 0) |\n                \n                # Price below trend (trend reversal)\n                (dataframe['close'] < dataframe['trend'])\n            ),\n            'exit_long'] = 1\n        \n        return dataframe\n    \n    def custom_stoploss(self, pair: str, trade, current_time, current_rate, \n                        current_profit, **kwargs) -> float:\n        \"\"\"\n        Custom dynamic stoploss based on ATR\n        \"\"\"\n        dataframe, _ = self.dp.get_analyzed_dataframe(pair, self.timeframe)\n        last_candle = dataframe.iloc[-1].squeeze()\n        \n        # Use ATR-based dynamic stoploss\n        atr = last_candle['atr']\n        atr_stop = -(self.atr_multiplier.value * atr / current_rate)\n        \n        # Return the more conservative stoploss\n        return max(self.stoploss, atr_stop)\n    \n    def confirm_trade_entry(self, pair: str, order_type: str, amount: float, \n                           rate: float, time_in_force: str, current_time,\n                           entry_tag: str, side: str, **kwargs) -> bool:\n        \"\"\"\n        Additional confirmation before placing entry order\n        \"\"\"\n        dataframe, _ = self.dp.get_analyzed_dataframe(pair, self.timeframe)\n        last_candle = dataframe.iloc[-1].squeeze()\n        \n        # Additional safety checks\n        # Ensure ATR is not too high (avoid entering during extreme volatility)\n        if last_candle['atr'] > last_candle['close'] * 0.05:  # ATR > 5% of price\n            return False\n        \n        # Ensure volume is sufficient\n        if last_candle['volume'] < last_candle['volume_ma'] * 0.5:\n            return False\n        \n        return True\n",
  "configPath": "user_data/config.json",
  "configContent": "{\n  \"$schema\": \"https://schema.freqtrade.io/schema.json\",\n  \"strategy\": \"UniversalMACD\",\n  \"max_open_trades\": 8,\n  \"stake_currency\": \"USDT\",\n  \"stake_amount\": \"unlimited\",\n  \"tradable_balance_ratio\": 0.99,\n  \"fiat_display_currency\": \"USD\",\n  \"dry_run\": true,\n  \"dry_run_wallet\": 50,\n  \"trading_mode\": \"spot\",\n  \"timeframe\": \"5m\",\n  \"cancel_open_orders_on_exit\": true,\n  \"use_exit_signal\": true,\n  \"entry_pricing\": {\n    \"price_side\": \"same\",\n    \"use_order_book\": true,\n    \"order_book_top\": 1,\n    \"price_last_balance\": 0,\n    \"check_depth_of_market\": {\n      \"enabled\": false,\n      \"bids_to_ask_delta\": 1\n    }\n  },\n  \"exit_pricing\": {\n    \"price_side\": \"other\",\n    \"use_order_book\": true,\n    \"order_book_top\": 1\n  },\n  \"exchange\": {\n    \"name\": \"binance\",\n    \"key\": \"\",\n    \"secret\": \"\",\n    \"method\": \"StaticPairList\",\n    \"pair_whitelist\": [\n      \"BTC/USDT\",\n      \"ETH/USDT\",\n      \"BNB/USDT\",\n      \"SOL/USDT\",\n      \"ADA/USDT\",\n      \"XRP/USDT\",\n      \"DOT/USDT\",\n      \"DOGE/USDT\",\n      \"AVAX/USDT\",\n      \"LINK/USDT\",\n      \"MATIC/USDT\",\n      \"LTC/USDT\",\n      \"TRX/USDT\",\n      \"UNI/USDT\",\n      \"ATOM/USDT\",\n      \"XLM/USDT\",\n      \"ETC/USDT\",\n      \"BCH/USDT\",\n      \"NEAR/USDT\",\n      \"FIL/USDT\",\n      \"APT/USDT\",\n      \"ARB/USDT\",\n      \"OP/USDT\",\n      \"ICP/USDT\",\n      \"ALGO/USDT\",\n      \"AAVE/USDT\",\n      \"SAND/USDT\",\n      \"MANA/USDT\",\n      \"FTM/USDT\",\n      \"EGLD/USDT\",\n      \"RUNE/USDT\",\n      \"INJ/USDT\",\n      \"GALA/USDT\",\n      \"HBAR/USDT\",\n      \"VET/USDT\"\n    ],\n    \"pair_blacklist\": [],\n    \"ccxt_config\": {\n      \"enableRateLimit\": true,\n      \"timeout\": 120000\n    },\n    \"ccxt_async_config\": {\n      \"enableRateLimit\": true,\n      \"timeout\": 120000\n    },\n    \"fees\": {\n      \"maker\": 0.001,\n      \"taker\": 0.001\n    }\n  },\n  \"pairlists\": [\n    {\n      \"method\": \"StaticPairList\",\n      \"pair_whitelist\": [\n        \"BTC/USDT\",\n        \"ETH/USDT\",\n        \"BNB/USDT\",\n        \"SOL/USDT\",\n        \"ADA/USDT\",\n        \"XRP/USDT\",\n        \"DOT/USDT\",\n        \"DOGE/USDT\",\n        \"AVAX/USDT\",\n        \"LINK/USDT\",\n        \"MATIC/USDT\",\n        \"LTC/USDT\",\n        \"TRX/USDT\",\n        \"UNI/USDT\",\n        \"ATOM/USDT\",\n        \"XLM/USDT\",\n        \"ETC/USDT\",\n        \"BCH/USDT\",\n        \"NEAR/USDT\",\n        \"FIL/USDT\",\n        \"APT/USDT\",\n        \"ARB/USDT\",\n        \"OP/USDT\",\n        \"ICP/USDT\",\n        \"ALGO/USDT\",\n        \"AAVE/USDT\",\n        \"SAND/USDT\",\n        \"MANA/USDT\",\n        \"FTM/USDT\",\n        \"EGLD/USDT\",\n        \"RUNE/USDT\",\n        \"INJ/USDT\",\n        \"GALA/USDT\",\n        \"HBAR/USDT\",\n        \"VET/USDT\"\n      ],\n      \"pair_blacklist\": []\n    }\n  ],\n  \"telegram\": {\n    \"enabled\": false,\n    \"token\": \"\",\n    \"chat_id\": \"\"\n  },\n  \"api_server\": {\n    \"enabled\": true,\n    \"listen_ip_address\": \"127.0.0.1\",\n    \"listen_port\": 8080,\n    \"verbosity\": \"error\",\n    \"enable_openapi\": true,\n    \"jwt_secret_key\": \"obEY6PIEi06ZZKzvRpG4QhweSK58gf-8Xpn\",\n    \"ws_token\": \"MweZ3_n4wXmLbZxVtQCbEfCBT1D_ox\",\n    \"CORS_origins\": [\n      \"\"\n    ],\n    \"username\": \"\",\n    \"password\": \"\"\n  },\n  \"bot_name\": \"4tiee\",\n  \"initial_state\": \"running\",\n  \"force_entry_enable\": true,\n  \"internals\": {\n    \"process_throttle_secs\": 5\n  },\n  \"dataformat_ohlcv\": \"json\",\n  \"dataformat_trades\": \"feather\",\n  \"freqaimodel\": \"XGBoostRegressor\",\n  \"freqai\": {\n    \"enabled\": false,\n    \"identifier\": \"qs_v9_scalp_5m1h_l2\",\n    \"write_metrics_to_disk\": false,\n    \"purge_old_models\": 2,\n    \"conv_width\": 1,\n    \"train_period_days\": 21,\n    \"backtest_period_days\": 3,\n    \"live_retrain_hours\": 12,\n    \"expiration_hours\": 0,\n    \"save_backtest_models\": false,\n    \"fit_live_predictions_candles\": 120,\n    \"data_kitchen_thread_count\": 0,\n    \"activate_tensorboard\": false,\n    \"wait_for_training_iteration_on_reload\": true,\n    \"continual_learning\": false,\n    \"keras\": false,\n    \"override_exchange_check\": false,\n    \"feature_parameters\": {\n      \"include_corr_pairlist\": [\n        \"BTC/USDT\",\n        \"ETH/USDT\",\n        \"BNB/USDT\",\n        \"SOL/USDT\",\n        \"ADA/USDT\",\n        \"XRP/USDT\",\n        \"DOT/USDT\",\n        \"DOGE/USDT\",\n        \"AVAX/USDT\",\n        \"LINK/USDT\",\n        \"MATIC/USDT\",\n        \"LTC/USDT\",\n        \"TRX/USDT\",\n        \"UNI/USDT\",\n        \"ATOM/USDT\",\n        \"XLM/USDT\",\n        \"ETC/USDT\",\n        \"BCH/USDT\",\n        \"NEAR/USDT\",\n        \"FIL/USDT\",\n        \"APT/USDT\",\n        \"ARB/USDT\",\n        \"OP/USDT\",\n        \"ICP/USDT\",\n        \"ALGO/USDT\",\n        \"AAVE/USDT\",\n        \"SAND/USDT\",\n        \"MANA/USDT\",\n        \"FTM/USDT\",\n        \"EGLD/USDT\",\n        \"RUNE/USDT\",\n        \"INJ/USDT\",\n        \"GALA/USDT\",\n        \"HBAR/USDT\",\n        \"VET/USDT\"\n      ],\n      \"include_timeframes\": [\n        \"5m\",\n        \"15m\",\n        \"1h\"\n      ],\n      \"label_period_candles\": 2,\n      \"include_shifted_candles\": 2,\n      \"DI_threshold\": 0,\n      \"weight_factor\": 0.3,\n      \"principal_component_analysis\": false,\n      \"indicator_periods_candles\": [\n        7,\n        14,\n        28\n      ],\n      \"use_SVM_to_remove_outliers\": false,\n      \"plot_feature_importances\": 0,\n      \"shuffle_after_split\": false,\n      \"buffer_train_data_candles\": 0\n    },\n    \"data_split_parameters\": {\n      \"test_size\": 0,\n      \"random_state\": 42,\n      \"shuffle\": false\n    },\n    \"model_training_parameters\": {\n      \"n_estimators\": 500,\n      \"max_depth\": 5,\n      \"learning_rate\": 0.05,\n      \"subsample\": 0.8,\n      \"colsample_bytree\": 0.7,\n      \"reg_lambda\": 1,\n      \"min_child_weight\": 5\n    }\n  }\n}",
  "runInput": {
    "strategyName": "user_data/strategies/mabStra.py",
    "config": {
      "timeframe": "5m",
      "timerange": "20260108-20260207",
      "stake_amount": 50,
      "pairs": [
        "ICP/USDT",
        "VET/USDT",
        "DOT/USDT",
        "ADA/USDT",
        "BNB/USDT",
        "XRP/USDT"
      ],
      "max_open_trades": 5
    }
  }
}